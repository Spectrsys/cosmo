<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">

    <formats>
        <format>tar.gz</format>
        <!--
        <format>tar.bz2</format>
        <format>zip</format>
        -->
    </formats>
    <fileSets>
        <fileSet>
            <directory>src/main/resources</directory>
            <outputDirectory>/</outputDirectory>
        </fileSet>
        <fileSet>
            <directory>src/main/config/</directory>
            <outputDirectory>tomcat/common/classes/</outputDirectory>
            <includes>
                <include>log4j.xml</include>
            </includes>
        </fileSet>
        <fileSet>
            <directory>src/main/config/</directory>
            <outputDirectory>etc/</outputDirectory>
            <includes>
                <include>cosmo.properties</include>
            </includes>
        </fileSet>

        <!-- Include cosmo-migration files -->
        <fileSet>
            <directory>../migration/src/main/config</directory>
            <outputDirectory>migration</outputDirectory>
            <includes>
                <include>migration.properties</include>
            </includes>
        </fileSet>
        <fileSet>
            <directory>../migration/src/docs</directory>
            <outputDirectory>migration</outputDirectory>
            <includes>
                <include>README.txt</include>
            </includes>
        </fileSet>
        <fileSet>
            <directory>../migration/target/</directory>
            <outputDirectory>migration</outputDirectory>
            <includes>
                <include>cosmo-migration-${pom.version}-jar-with-dependencies.jar</include>
            </includes>
        </fileSet>
    </fileSets>

    <!-- 
    <files>
        <file>
            <source>${basedir}/src/main/config/server.xml</source>
            <outputDirectory>tomcat/conf/</outputDirectory>
            <fileMode>420</fileMode>
        </file>
        <file>
            <source>${basedir}/../cosmo/target/cosmo-${pom.version}.war</source>
            <outputDirectory>tomcat/webapps/</outputDirectory>
            <destName>chandler.war</destName>
            <filtered>false</filtered>
            <fileMode>420</fileMode>
        </file>
        <file>
            <source>${basedir}/../cosmo/build/context.xml</source>
            <outputDirectory>tomcat/conf/Catalina/localhost</outputDirectory>
            <destName>chandler.xml</destName>
            <filtered>false</filtered>
            <fileMode>420</fileMode>
        </file>
    </files> -->
    

    <dependencySets>
        <dependencySet>
            <outputDirectory>tomcat/</outputDirectory>
            <scope>runtime</scope>
            <unpack>true</unpack>
            <includes>
                <include>org.osaf:apache-tomcat</include>
            </includes>
        </dependencySet>
        <dependencySet>
            <outputDirectory>tomcat/common/lib</outputDirectory>
            <includes>
                <include>javax.activation:activation</include>
                <include>commons-logging:commons-logging</include>
                <include>javamail:mailapi</include>
                <include>javamail:smtp</include>
                <include>javax.mail:mail</include>
                <include>log4j:log4j</include>
                <include>org.apache.derby:derby</include>
                <include>mysql:mysql-connector-java</include>
                <include>postgresql:postgresql</include>
            </includes>
        </dependencySet>
        <dependencySet>
            <outputDirectory>tomcat/common/endorsed</outputDirectory>
            <includes>
                <include>xalan:xalan</include>
                <include>xalan:serializer</include>
                <include>xerces:xercesImpl</include>
                <include>xml-apis:xml-apis</include>
            </includes>
        </dependencySet>
        <dependencySet>
            <outputDirectory>tomcat/webapps/</outputDirectory>
            <scope>runtime</scope>
            <includes>
                <include>org.osaf.cosmo:cosmo</include>
            </includes>
        </dependencySet>

        <dependencySet>
            <includes>
              <include>org.osaf.cosmo:chandler:war</include>
            </includes>
            <outputDirectory>tomcat/webapps/</outputDirectory>
            <outputFileNameMapping>${artifactId}.war</outputFileNameMapping>
            <fileMode>420</fileMode>
        </dependencySet>
    </dependencySets>
</assembly>

